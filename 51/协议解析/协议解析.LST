C51 COMPILER V9.00   协议_析                                                              07/06/2017 15:11:11 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE 协议_析
OBJECT MODULE PLACED IN 协议解析.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE 协议解析.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1                   #include <string.h>
   2                   #include <reg52.h>
   3          
   4          #define FOSC 11059200L
   5          
   6          #define BAUD 9600
   7          
   8           
   9          
  10          /***********************************/
  11          
  12          // 串口初始化程序
  13          
  14          /***********************************/
  15          
  16          void uartInit( )
  17          
  18          {
  19   1      
  20   1          SCON = 0x50;
  21   1      
  22   1          TMOD |= 0x20;
  23   1      
  24   1          TH1=TL1 = -(FOSC/12/32/BAUD);
  25   1      
  26   1          TR1 =1;
  27   1      
  28   1          ES = 1;
  29   1      
  30   1          EA =1;
  31   1      
  32   1      }
  33          
  34           
  35          
  36          /***********************************/
  37          
  38          // 串口1发送一个字节到上位机
  39          
  40          /***********************************/
  41          
  42          void uartSendData(unsigned char dat)    
  43          
  44          {   
  45   1      
  46   1           SBUF=dat;
  47   1      
  48   1          while(TI==0);       
  49   1      
  50   1           TI=0;   
  51   1      
  52   1      }
  53          
  54          /***********************************/
  55          
C51 COMPILER V9.00   协议_析                                                              07/06/2017 15:11:11 PAGE 2   

  56          // 串口发送一个数组到上位机
  57          
  58          /***********************************/
  59          
  60          void uartSendArray(unsigned char *dat, unsigned  char len )
  61          
  62          {
  63   1      
  64   1          unsigned char i;
  65   1      
  66   1         for(i=0; i<len; i++)
  67   1      
  68   1         {
  69   2      
  70   2               uartSendData(*dat);
  71   2      
  72   2                 dat++;
  73   2      
  74   2         }
  75   1      
  76   1      }
  77          
  78           
  79          
  80          //-----------------------------------
  81          
  82          //          串口1中断程序
  83          
  84          //------------------------------------
  85          
  86           
  87          
  88          void uart_Isr( )interrupt 4
  89          
  90          {
  91   1      
  92   1        unsigned char dat =SBUF;
  93   1      
  94   1        if(RI)
  95   1      
  96   1        {
  97   2      
  98   2              RI=0; 
  99   2      
 100   2              uartRecive(dat);   //接收数据函数       
*** WARNING C206 IN LINE 100 OF 协议解析.C: 'uartRecive': missing function-prototype
*** ERROR C267 IN LINE 100 OF 协议解析.C: 'uartRecive': requires ANSI-style prototype
 101   2      
 102   2        }
 103   1      
 104   1          
 105   1      
 106   1       
 107   1      
 108   1      if(TI)
 109   1      
 110   1        {
 111   2      
 112   2            / / TI=0; 
*** ERROR C141 IN LINE 112 OF 协议解析.C: syntax error near '/'
 113   2      
 114   2        } 
C51 COMPILER V9.00   协议_析                                                              07/06/2017 15:11:11 PAGE 3   

 115   1      
 116   1      }
 117          
 118           
 119          
 120          void main(  )
 121          
 122          {
 123   1      
 124   1           unsigned char m,  n;
 125   1      
 126   1          char buf[ ]="hello world!\r\n";
 127   1      
 128   1            uartInit(   );
 129   1      
 130   1           while(1)
 131   1      
 132   1          {
 133   2      
 134   2              for(m=0;m<200;m++)
 135   2      
 136   2                  for(n=0;n<200;n++);
 137   2      
 138   2                 uartSendArray(buf,  strlen(buf));
 139   2      
 140   2          }
 141   1      
 142   1      }

C51 COMPILATION COMPLETE.  1 WARNING(S),  2 ERROR(S)
